# 🧪 完整测试指南

## 📋 快速导航

### 🚀 快速开始（5 分钟）
```bash
# 终端 1: 启动后端
cd ai-education-service
python -m uvicorn main:app --reload --port 8000

# 终端 2: 启动前端
cd 前端web
npm run dev

# 浏览器: 打开应用
http://localhost:3000
```

### 📝 测试文档
| 文档 | 用途 | 时间 |
|------|------|------|
| `HITL_QUICK_TEST.md` | 快速验证 HITL 功能 | 5 分钟 |
| `HITL_TESTING_STEP_BY_STEP.md` | 详细测试步骤 | 15 分钟 |
| `HITL_TESTING_CHECKLIST.md` | 完整测试清单 | 30 分钟 |
| `HITL_DEMO_SCRIPT.md` | 演示脚本 | 5 分钟 |

## 🎯 测试流程

### 第 1 步：环境准备
- [ ] 后端已启动 (http://localhost:8000)
- [ ] 前端已启动 (http://localhost:3000)
- [ ] 浏览器开发者工具已打开 (F12)

### 第 2 步：基础功能测试
- [ ] 能登录应用
- [ ] 能进入 book-chat-v2 页面
- [ ] 能发送消息
- [ ] 能看到 AI 回复

### 第 3 步：HITL 功能测试
- [ ] 能检测到中断
- [ ] 能显示审批模态框
- [ ] 能看到操作信息
- [ ] 能看到决策按钮

### 第 4 步：决策测试
- [ ] 批准决策能工作
- [ ] 拒绝决策能工作
- [ ] 编辑决策能工作
- [ ] 决策提交能工作

### 第 5 步：恢复测试
- [ ] 能恢复执行
- [ ] 能继续处理流
- [ ] 能显示最终结果
- [ ] 能保存对话

## 🔍 关键日志

在浏览器控制台中查找：

```javascript
// 1. 发送请求
🤖 发送 AI 请求: {...}

// 2. 获取 thread_id
🔗 保存 thread_id: thread_xxx

// 3. 检测中断
🛑 检测到 HITL 中断，显示审批模态框

// 4. 提交决策
📤 提交 HITL 决策: [...]

// 5. 恢复完成
✅ 恢复执行完成

// 6. 对话已保存
💾 对话已保存: xxx
```

## ✅ 成功标志

看到以下任何一个就说明成功：

```
✅ HITL 审批模态框显示
✅ 看到操作信息
✅ 看到决策按钮
✅ 决策提交后 AI 继续执行
✅ 对话正常保存
✅ 没有 404 错误
```

## 🐛 常见问题

### Q1: 看到 404 错误
**错误**: `POST http://localhost:3000/api/letta/sync 404`
**解决**: 已修复，刷新页面重试

### Q2: 模态框不显示
**原因**: 中断检测失败
**解决**: 检查消息是否触发 memory_write

### Q3: 后端离线
**原因**: 服务未启动
**解决**: 重启后端服务

### Q4: 前端崩溃
**原因**: 代码错误
**解决**: 检查控制台错误信息

## 📊 测试结果记录

### 环境信息
- 日期: ___________
- 浏览器: ___________
- 操作系统: ___________

### 测试结果
- 基础功能: ✅ / ❌
- HITL 功能: ✅ / ❌
- 决策功能: ✅ / ❌
- 恢复功能: ✅ / ❌

### 发现的问题
1. _________________________________
2. _________________________________

## 🎊 完成标准

### 最小要求
- ✅ 能检测到中断
- ✅ 能显示模态框
- ✅ 能提交决策
- ✅ 能恢复执行

### 推荐要求
- ✅ 所有决策类型都能工作
- ✅ 没有控制台错误
- ✅ 性能指标达标

### 完整要求
- ✅ 所有测试项目通过
- ✅ 没有已知问题
- ✅ 可以部署到生产

## 🚀 下一步

### 如果测试通过
1. 部署到测试环境
2. 进行用户验收测试
3. 部署到生产环境
4. 监控和优化

### 如果测试失败
1. 查看错误日志
2. 查看常见问题
3. 修复问题
4. 重新测试

---

**选择一个测试方式开始吧！** 🚀

